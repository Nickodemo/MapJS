<!DOCTYPE html>
<html>
<meta charset="utf-8" />
<head>
	<script src="./leaflet.js"></script>
	<link rel="stylesheet" href="./leaflet.css" />
	<!--<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>-->
	<!--<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />-->	
	<!--<script src="./Leaflet.MousePosition-master/src/L.Control.MousePosition.js"></script>-->
	<!--<link rel="stylesheet" href="./Leaflet.MousePosition-master/src/L.Control.MousePosition.css"/>-->
	
	<script src="./mouseCoordinate-master/leaflet.mouseCoordinate.js"></script>
	<link rel="stylesheet" href="./mouseCoordinate-master/leaflet.mouseCoordinate.css"/>
		
	<script src="./Leaflet.Sync-master/L.Map.Sync.js"></script>
	<script src="./Leaflet-MiniMap-master/src/Control.MiniMap.js"></script>
	<link rel="stylesheet" href="./Leaflet-MiniMap-master/src/Control.MiniMap.css" />
	
	<script src="./Usos_suelo_1987.js"></script>
	<script src="./Usos_suelo_2014.js"></script>
<style>
	#map1987 {
		float: left;
	}
	
	#map2014 {
		float: right;
	}
	
	.mapa_sync{
		width: 49%;
		height: 600px;
		box-shadow: 5px 5px 5px #888;
	}

</style>
</head>

	<body>
		<div id='map1987' class='mapa_sync'></div>
		<div id='map2014' class='mapa_sync'></div>
		<script>

		function getColor(Usos_suelo) { 
			return  Usos_suelo === "Terrenos con escasa o nula vegetacion" ? '#EFE4BE' : 
					Usos_suelo === "Salinas" ? '#D2EBFF' : 
					Usos_suelo === "Pastizal" ? '#B3FCB3' : 
					Usos_suelo === "Masas de agua" ? '#97DBF2' : 
					Usos_suelo === "Huerta" ? '#EEF1F2' : 
					Usos_suelo === "Frutal" ? '#D68589' : 
					Usos_suelo === "Cultivos forzados" ? '#F0F0F0' : 
					Usos_suelo === "Arbolado forestal" ? '#73B273':
									'#7A6612'; 
		}
		
		function style(feature) { 
			return {fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 0, 
					opacity: 1,
					fillOpacity: 0.7 
				}; 
		}
		
		function popup(feature, layer) { 
			if (feature.properties && feature.properties.Usos_suelo) { 
				layer.bindPopup(feature.properties.Usos_suelo); 
			} 
		}
		
		//Constructor mapa2
		var map2014 = L.map('map2014', {
			center: [36.76,-2.67], 
			zoom: 10,
			attributionControl: false,
		});
		
		//Constructor mapa2
		var map1987= L.map('map1987', {
			center: [36.76,-2.67], 
			zoom: 10,
			attributionControl: false,
		});

		//Cargamos la capa municipios
		/*L.geoJson(municipios, { 
			style: { //fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 2, 
					opacity: 1, 
					color: 'black', 
					dashArray: '3', 
					fillOpacity: 0.7 
				}	
		}).addTo(map);
		
		//Cargamos la capa comarca
		L.geoJson(comarca, { 
			style: {// fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 2, 
					opacity: 1, 
					color: 'blue', 
					dashArray: '3', 
					fillOpacity: 0.7 
				}
		}).addTo(map);*/
		
		//Cargamos la capa Usos_suelo_2014
		L.geoJson(Usos_suelo_2014,{ 
			style: style,
			onEachFeature: popup			
		}).addTo(map2014);
		
		//Cargamos la capa Usos_suelo_1987
		L.geoJson(Usos_suelo_1987,{ 
			style: style,
			onEachFeature: popup	
		}).addTo(map1987);
		
		//Añadimos mapa base como tileLayer al mapa de 1987
		var OSM1987 = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org"> OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery © <a href="http://mapbox.com">Mapbox</a>', 
			id: 'mapbox.light', 
			maxZoom: 18,
		}).addTo(map1987);
		
		//Añadimos mapa base como tileLayer al mapa de 2017
		var OSM2014 = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org"> OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery © <a href="http://mapbox.com">Mapbox</a>', 
			id: 'mapbox.light', 
			maxZoom: 18,
		}).addTo(map2014);
				
		map1987.on('zoomend', function () {
			if (map1987.getZoom() > 12) {
				map1987.removeLayer(OSM1987);
			}else
			{
				map1987.addLayer(OSM1987);
			}   
		}); 
		
		map2014.on('zoomend', function () {
			if (map2014.getZoom() > 12) {
				map2014.removeLayer(OSM2014);
			}else
			{
				map2014.addLayer(OSM2014);
			}   
		}); 
		
		//Coordenadas del ratón
		L.control.mouseCoordinate({utm:true,gps:false,position:'bottomleft'}).addTo(map1987);
		L.control.mouseCoordinate({utm:true,gps:false,position:'bottomleft'}).addTo(map2014);
		
		//Escala distancia abajo izquierda
		L.control.scale().addTo(map2014);
		L.control.scale().addTo(map1987);
		
		//Mapa de situación
		var osm1= L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org"> OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery © <a href="http://mapbox.com">Mapbox</a>', 
			id: 'mapbox.light', 
			minZoom: 5, 
			maxZoom: 10,
		});
		
		var osm2= L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org"> OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery © <a href="http://mapbox.com">Mapbox</a>', 
			id: 'mapbox.light', 
			minZoom: 5, 
			maxZoom: 10,
		});
		
		var miniMap = new L.Control.MiniMap(osm1, {
			toggleDisplay: true,
			minimized: true
		}).addTo(map1987);
		
		var miniMap = new L.Control.MiniMap(osm2, {
			toggleDisplay: true,
			minimized: true
		}).addTo(map2014);
		
		//Sincronizar los mapas de 2014 y 1987 con leaflet.sync
		map2014.sync(map1987);
		map1987.sync(map2014);		
		</script>
	</body>
	
</html>