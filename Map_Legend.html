<!DOCTYPE html>
<html>
<meta charset="utf-8" />
<head>
	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<script src="Leaflet.TileLegend-master/Leaflet.TileLegend.js"></script>
	<link rel="stylesheet" src="Leaflet.TileLegend-master/Leaflet.TileLegend.css"/>
	<link rel="stylesheet" href="http://yohanboniface.github.io/Leaflet.EditInOSM/Leaflet.EditInOSM.css">
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
	<script src="http://yohanboniface.github.io/Leaflet.EditInOSM/Leaflet.EditInOSM.js"></script>
	<script src="http://mlevans.github.io/leaflet-hash/javascripts/leaflet-hash.js"></script>
	<script type="text/javascript" src="municipios.js"></script>
	<script type="text/javascript" src="comarca.js"></script>
	<script type="text/javascript" src="Usos_suelo_1987.js"></script>
	<script type="text/javascript" src="Usos_suelo_2014.js"></script>
	<script src="./legend.js"></script>
	
<style>
	#map {
		width: 100%;
		height: 100%;
		box-shadow: 5px 5px 5px #888;
	}

	body { margin:0; padding:0; }

	.usos .tilelegend-map {
		width: 100%;
	}
	.landuse .tilelegend-map {
		width: 100%;
		height: 60px;
	}
	.poi li > p, .poi li > div {
		display: inline-block;
		vertical-align: top;
	}
	.poi li {
		white-space: nowrap;
		overflow: hidden;
	}
	.poi li p {
		padding: 10px;
	}
	.leaflet-bar a, .leaflet-bar a:hover {
		height: 36px;
		line-height: 36px;
		width: 36px;
	}
</style>
</head>

	<body>
		<div id = 'map'></div>
		<script>
		
		/*var countryStyle = { 
			'color': "#858585", 
			'weight': 5, 
			'opacity': 0.6
		};*/
		
		
		var startPoint = [19.6718, -72.1304];
		var map = L.map('map', {attributionControl: false, editInOSMControl: true, editInOSMControlOptions: {position: 'topleft'}}).setView(startPoint, 13),
			tilelayer = L.tileLayer('http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {maxZoom: 20, legend: LEGEND, openLegendOnLoad: true, attribution: 'Data \u00a9 <a href="http://www.openstreetmap.org/copyright"> OpenStreetMap Contributors </a> Tiles \u00a9 HOT'}).addTo(map),
			hash = new L.Hash(map);
			legend = (new L.Control.TileLegend()).addTo(map);
			// legend = new L.TileLegend(map, tilelayer, L.DomUtil.get('leaflet-control-tilelegend-container'), LEGEND);
			// legend.open();
		
		
		var map = L.map('map', {
			center: [36.76,-2.67], 
			zoom: 10,
			attributionControl: false,
			editInOSMControl: true,
			editInOSMControlOptions: {position: 'topleft'}
		});
		
	
		function getColor(Usos_suelo) { 
			return  Usos_suelo === "Terrenos con escasa o nula vegetacion" ? '#EFE4BE' : 
					Usos_suelo === "Salinas" ? '#D2EBFF' : 
					Usos_suelo === "Pastizal" ? '#B3FCB3' : 
					Usos_suelo === "Masas de agua" ? '#97DBF2' : 
					Usos_suelo === "Huerta" ? '#EEF1F2' : 
					Usos_suelo === "Frutal" ? '#D68589' : 
					Usos_suelo === "Cultivos forzados" ? '#F0F0F0' : 
					Usos_suelo === "Arbolado forestal" ? '#73B273':
									'#7A6612'; 
		}
		
		function style(feature) { 
			return { fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 0, 
					opacity: 1,
					fillOpacity: 0.7 
				}; 
		}
		
		function popup(feature, layer) { 
			if (feature.properties && feature.properties.Usos_suelo) { 
				layer.bindPopup(feature.properties.Usos_suelo); 
			} 
		}
		
		L.control.scale().addTo(map);
		
		//Cargamos la capa municipios
		/*L.geoJson(municipios, { 
			style: { //fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 2, 
					opacity: 1, 
					color: 'black', 
					dashArray: '3', 
					fillOpacity: 0.7 
				}	
		}).addTo(map);
		
		//Cargamos la capa comarca
		L.geoJson(comarca, { 
			style: {// fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 2, 
					opacity: 1, 
					color: 'blue', 
					dashArray: '3', 
					fillOpacity: 0.7 
				}
		}).addTo(map);
		
		//Cargamos la capa Usos_suelo_1987
		L.geoJson(Usos_suelo_1987, { 
			style: { fillColor: getColor(feature.properties.Usos_suelo), 
					weight: 2, 
					opacity: 1, 
					color: 'black', 
					dashArray: '3', 
					fillOpacity: 0.7 
				}	
		}).addTo(map);*/
		
		//Cargamos la capa Usos_suelo_2014
		L.geoJson(Usos_suelo_2014, { 
			style: style,
			onEachFeature: popup 
		}).addTo(map);
		
		var OSM = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			//attribution: 'Map data &copy; <a href="http://openstreetmap.org"> OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery Â© <a href="http://mapbox.com">Mapbox</a>', 
			id: 'mapbox.light', 
			openLegendOnLoad: true,
			maxZoom: 18,
			legend: legend
		}).addTo(map);
		
		var legendControl = (new L.Control.TileLegend()).addTo(map);
		
		/*geojson = L.geoJson(municipios, { 
			style: style, 
			onEachFeature: popup 
		}).addTo(map);*/

		
		debugger;		
				
		</script>
	</body>
	
</html>